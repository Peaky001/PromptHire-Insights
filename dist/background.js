/*! For license information please see background.js.LICENSE.txt */
(()=>{function n(){var t,r,o="function"==typeof Symbol?Symbol:{},c=o.iterator||"@@iterator",i=o.toStringTag||"@@toStringTag";function a(n,o,c,i){var a=o&&o.prototype instanceof u?o:u,l=Object.create(a.prototype);return e(l,"_invoke",function(n,e,o){var c,i,a,u=0,l=o||[],p=!1,f={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(n,e){return c=n,i=0,a=t,f.n=e,s}};function d(n,e){for(i=n,a=e,r=0;!p&&u&&!o&&r<l.length;r++){var o,c=l[r],d=f.p,h=c[2];n>3?(o=h===e)&&(a=c[(i=c[4])?5:(i=3,3)],c[4]=c[5]=t):c[0]<=d&&((o=n<2&&d<c[1])?(i=0,f.v=e,f.n=c[1]):d<h&&(o=n<3||c[0]>e||e>h)&&(c[4]=n,c[5]=e,f.n=h,i=0))}if(o||n>1)return s;throw p=!0,e}return function(o,l,h){if(u>1)throw TypeError("Generator is already running");for(p&&1===l&&d(l,h),i=l,a=h;(r=i<2?t:a)||!p;){c||(i?i<3?(i>1&&(f.n=-1),d(i,a)):f.n=a:f.v=a);try{if(u=2,c){if(i||(o="next"),r=c[o]){if(!(r=r.call(c,a)))throw TypeError("iterator result is not an object");if(!r.done)return r;a=r.value,i<2&&(i=0)}else 1===i&&(r=c.return)&&r.call(c),i<2&&(a=TypeError("The iterator does not provide a '"+o+"' method"),i=1);c=t}else if((r=(p=f.n<0)?a:n.call(e,f))!==s)break}catch(n){c=t,i=1,a=n}finally{u=1}}return{value:r,done:p}}}(n,c,i),!0),l}var s={};function u(){}function l(){}function p(){}r=Object.getPrototypeOf;var f=[][c]?r(r([][c]())):(e(r={},c,function(){return this}),r),d=p.prototype=u.prototype=Object.create(f);function h(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,p):(n.__proto__=p,e(n,i,"GeneratorFunction")),n.prototype=Object.create(d),n}return l.prototype=p,e(d,"constructor",p),e(p,"constructor",l),l.displayName="GeneratorFunction",e(p,i,"GeneratorFunction"),e(d),e(d,i,"Generator"),e(d,c,function(){return this}),e(d,"toString",function(){return"[object Generator]"}),(n=function(){return{w:a,m:h}})()}function e(n,t,r,o){var c=Object.defineProperty;try{c({},"",{})}catch(n){c=0}e=function(n,t,r,o){function i(t,r){e(n,t,function(n){return this._invoke(t,r,n)})}t?c?c(n,t,{value:r,enumerable:!o,configurable:!o,writable:!o}):n[t]=r:(i("next",0),i("throw",1),i("return",2))},e(n,t,r,o)}function t(n,e,t,r,o,c,i){try{var a=n[c](i),s=a.value}catch(n){return void t(n)}a.done?e(s):Promise.resolve(s).then(r,o)}function r(n){return function(){var e=this,r=arguments;return new Promise(function(o,c){var i=n.apply(e,r);function a(n){t(i,o,c,a,s,"next",n)}function s(n){t(i,o,c,a,s,"throw",n)}a(void 0)})}}chrome.runtime.onInstalled.addListener(function(){console.log("LinkedIn Profile Scraper extension installed")}),chrome.runtime.onSuspend.addListener(function(){console.log("Extension is being suspended, clearing job selection"),chrome.storage.sync.remove(["selectedJobOpening"],function(){console.log("Job selection cleared on extension suspend")})}),chrome.management.onDisabled.addListener(function(n){n.id===chrome.runtime.id&&(console.log("Extension is being disabled, clearing job selection"),chrome.storage.sync.remove(["selectedJobOpening"],function(){console.log("Job selection cleared on extension disable")}))}),chrome.runtime.onMessage.addListener(function(n,e,t){return"scrapeProfile"===n.action?(chrome.tabs.query({active:!0,currentWindow:!0},function(e){e[0]?chrome.tabs.sendMessage(e[0].id,n,function(n){chrome.runtime.lastError?t({success:!1,error:"Content script not available. Please refresh the LinkedIn page."}):t(n)}):t({success:!1,error:"No active tab found"})}),!0):"sendToAPI"===n.action?(function(n,e){return s.apply(this,arguments)}(n.data,n.apiUrl).then(function(n){return t({success:!0,response:n})}).catch(function(n){return t({success:!1,error:n.message})}),!0):"fetchJobOpenings"===n.action?(function(){return i.apply(this,arguments)}().then(function(n){return t({success:!0,data:n})}).catch(function(n){return t({success:!1,error:n.message})}),!0):"sendApplicant"===n.action?(function(n){return a.apply(this,arguments)}(n.data).then(function(n){return t({success:!0,response:n})}).catch(function(n){return t({success:!1,error:n.message})}),!0):void 0});var o="https://prompthire.org/api",c="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiNjhkZjdlYjNkNDQ1NWJlNTM5ZWVhMDdiIiwidXNlcl9uYW1lIjoicGhsaW5rZWRpbiIsInVzZXJfZW1haWwiOiJzaHJleWFzaEBwcm9tcHRoaXJlLmFpIiwib3JnX2lkcyI6WyI2NzNmNjU0NzExZmJlN2U1ZWQxZjM5MmUiXSwiZXhwIjoxNzYwNzczNDUyfQ.lCZEYRd0BNdLz8d96vwJHf7ZLEAUbAdSt6XOMgPGTnY";function i(){return(i=r(n().m(function e(){var t,r,i,a;return n().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,console.log("Fetching job openings from:","".concat(o,"/jobopenings")),n.n=1,fetch("".concat(o,"/jobopenings"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(c)}});case 1:if(t=n.v,console.log("Job openings response status:",t.status),t.ok){n.n=3;break}return n.n=2,t.text();case 2:throw r=n.v,console.error("Job openings API error:",r),new Error("Failed to fetch job openings: ".concat(t.status," ").concat(t.statusText," - ").concat(r));case 3:return n.n=4,t.json();case 4:return i=n.v,console.log("Job openings result:",i),n.a(2,i);case 5:throw n.p=5,a=n.v,console.error("Fetch job openings error:",a),a;case 6:return n.a(2)}},e,null,[[0,5]])}))).apply(this,arguments)}function a(){return(a=r(n().m(function e(t){var r,i,a,s;return n().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,console.log("Sending applicant to:","".concat(o,"/applicants")),console.log("Applicant data:",t),n.n=1,fetch("".concat(o,"/applicants"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(c)},body:JSON.stringify(t)});case 1:if(r=n.v,console.log("Send applicant response status:",r.status),r.ok){n.n=3;break}return n.n=2,r.text();case 2:throw i=n.v,console.error("Send applicant API error:",i),new Error("Failed to send applicant: ".concat(r.status," ").concat(r.statusText," - ").concat(i));case 3:return n.n=4,r.json();case 4:return a=n.v,console.log("Send applicant result:",a),n.a(2,a);case 5:throw n.p=5,s=n.v,console.error("Send applicant error:",s),s;case 6:return n.a(2)}},e,null,[[0,5]])}))).apply(this,arguments)}function s(){return(s=r(n().m(function e(t,r){var o,c,i;return n().w(function(n){for(;;)switch(n.p=n.n){case 0:if(n.p=0,r){n.n=1;break}throw new Error("API URL is required");case 1:return n.n=2,fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({profileData:t,timestamp:(new Date).toISOString(),source:"linkedin-scraper-extension"})});case 2:if((o=n.v).ok){n.n=3;break}throw new Error("API call failed with status: ".concat(o.status));case 3:return n.n=4,o.json();case 4:return c=n.v,n.a(2,c);case 5:throw n.p=5,i=n.v,console.error("API call error:",i),i;case 6:return n.a(2)}},e,null,[[0,5]])}))).apply(this,arguments)}chrome.tabs.onActivated.addListener(function(){var e=r(n().m(function e(t){var r,o;return n().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,chrome.tabs.get(t.tabId);case 1:(r=n.v).url&&(r.url.includes("linkedin.com/in/")||r.url.includes("www.linkedin.com/in/"))&&chrome.action.enable(t.tabId),n.n=3;break;case 2:n.p=2,o=n.v,console.error("Error checking tab:",o);case 3:return n.a(2)}},e,null,[[0,2]])}));return function(n){return e.apply(this,arguments)}}()),console.log("LinkedIn Profile Scraper background script loaded")})();